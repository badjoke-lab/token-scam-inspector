## Check①は何か（仕様で固定）

Phase 1 の **Check ①** はこれ。

### **① Sell Restriction / Honeypot（売れない・売りづらい）**

**測ること（何を確認する項目か）**

* 「買えたのに **売れない**」
* あるいは「売れるけど **税率が極端**で実質売れない」
  みたいな **“売却側の制限”が疑われるサイン**を拾う。

**なぜ重要か（ざっくり）**

* 初心者が一番死ぬパターンがこれ（買った瞬間に出口がない）。


### Task 06 でできるようになること（完了後・

* **「売れない／売りづらい可能性」チェックが1つ動く**（unknown以外が出るケースが出てくる）
* **なぜそう言えるのか**が evidence として残る（例：ブラックリスト/取引制御っぽい記述を検出）
* ソース未公開などの場合も **unknown＋理由＋確認手順**を返せる

---

## ✅ タスク文ここから

```md
# Task 06 — Check 01: Sell Restriction / Honeypot (Phase 1 / Stage 4)

## PR title rule (MUST)
Set the PR title to:
- **Task 06: Check 01 (sell restriction)**

## What is this check?
Check #1 in the spec: **Sell Restriction / Honeypot**
Goal is to detect *signals* that selling may be blocked or heavily restricted.
No verdict language. No scoring.

## Source of truth (MUST FOLLOW)
- Specs: `docs/specs/**` (spec-phase1-ja.md section “① Sell Restriction / Honeypot”)
- Ops rules: `AGENTS.md`, `codex/**`
- Common rules: `codex/tasks/task-00-rules.md`

## Allowed changes
- May add/update: `workers/**`
- Must NOT edit: `docs/specs/**`

## Constraints (MUST)
- Do NOT add new endpoints
- Do NOT change response schema (no new top-level keys)
- Do NOT introduce “scam/safe/fraud” or investment advice
- Cache behavior must remain: HIT returns immediately

## Implementation plan

### 1) Implement `sell_restriction` check using **source-code pattern scan** (best-effort)
Use explorer data already introduced in Task 05:
- If contract source is available/verified and code text can be obtained:
  - Scan code for **common sell restriction signals** (simple string/pattern match only).
  - Examples of signals (keep minimal, no heavy parsing):
    - blacklist/whitelist gating: `blacklist`, `isBlacklisted`, `whitelist`, `onlyWhitelisted`
    - trading switch / transfer gate: `tradingEnabled`, `enableTrading`, `tradingOpen`, `whenTradingEnabled`
    - anti-bot / transfer delay that can block sells: `antiBot`, `cooldown`, `transferDelay`
    - explicit sell limitation hints: `maxSell`, `sellLimit`, `sellTax`
  - Based on findings, set result:
    - `high` : explicit blacklist/whitelist gating OR explicit trading switch that can block transfers
    - `warn` : anti-bot/cooldown/delay or tax-related hints (uncertain but relevant)
    - `ok`   : verified source exists AND none of the above signals found (still not a verdict)
- If source is missing/unverified/unavailable:
  - result must be `unknown` with an explainable reason (e.g. `source_unavailable` / `missing_api_key` / `upstream_error`)

### 2) Populate the check object strictly per schema
For the check item with:
- `id`: `sell_restriction`
- `label`: `Sell Restriction / Honeypot`

Fill:
- `result`: `ok | warn | high | unknown`
- `short`: keep spec short text (beginner-friendly)
- `detail`: keep spec detail text (beginner-friendly)
- `evidence`: include **concrete detected tokens** (e.g., `Found "blacklist" pattern`)
- `howToVerify`: include neutral steps (spec-aligned), e.g.
  - “Try a tiny swap on a trusted tool”
  - “Check explorer verified source / read the transfer restrictions”
(Do NOT add new fields)

### 3) Keep it neutral
Forbidden words:
- “scam”, “fraud”, “safe”
Forbidden advice:
- “buy/sell”, “you should invest”

Allowed:
- “risk signal”, “might”, “could”, “unknown”, “insufficient data”

### 4) Preserve cache behavior
- Cache HIT: return immediately (do not scan / do not call explorer)
- Cache MISS: run existing pipeline, compute this check, then cache result (Task 04 rules)

## Acceptance checklist
- [ ] `sell_restriction` check returns `unknown` with reason when source is unavailable
- [ ] When source exists, check returns `warn/high/ok` based on minimal pattern scan
- [ ] `evidence` contains at least 1 concrete string when result != unknown
- [ ] `howToVerify` is filled with beginner-friendly neutral steps
- [ ] No schema changes, no new endpoints
- [ ] No forbidden words / no scoring
- [ ] Cache HIT behavior unchanged
- [ ] No edits to `docs/specs/**`
```

## ✅ タスク文ここまで

---
https://github.com/badjoke-lab/token-scam-inspector/pull/7

https://da0ec44b.token-scam-inspector.pages.dev/



## ✅ Check ② の正式名称（仕様書どおり）

**② Owner Privileges（オーナー権限）**
「開発者（Owner）が後から重要ルールを変更できる設計か」を見るチェックです。([GitHub][1])

---

## ✅ これで何を測るのか（ざっくり）

**結論：**
「今は普通に見えても、後から“罠”に変えられる構造かどうか」を確認します。([GitHub][1])

例：

* 手数料（税）を極端に上げられる
* 特定ウォレットだけ売買できなくできる（ブラックリスト等）
* 取引条件（maxTx / maxWallet 等）を後から締め上げられる
  → こういう“後出し改変”ができる設計はリスク要因です。([GitHub][1])

---

## ✅ 仕様書に書いてある「表示すべき内容」（そのまま）

* **Short**：The owner may change critical rules.([GitHub][1])
* **Why**：Owner-controlled parameters can turn a token into a trap later.([GitHub][1])
* **Evidence**：Owner存在・権限関数の検出有無([GitHub][1])
* **短文要約**：開発者が自由に変更できるか([GitHub][1])

---

## ✅ Phase 1 での「現実的な判定方法」（どう実装するか）

Phase 1 は **ETH/BSC + Explorer中心**なので、以下のどれが取れたかで判定します。([GitHub][1])

### 取れるもの

* **コントラクトが Verified か**（ソースが公開されているか）
* **ABI / ソースから owner 関連の存在**

  * `owner()`, `getOwner()`, `transferOwnership`, `renounceOwnership` など
* **“変更系”っぽい関数名パターンの存在（Evidence用）**

  * `setFee`, `setTax`, `setBlacklist`, `excludeFromFee`, `setMaxTx`, `setMaxWallet` など
    ※ここは「確定」ではなく **“検出できたシグナル”として列挙**（断定しない）

### 取れないとき（Unknownの正当化）

* **未Verified**で ABI/ソースが取れない
  → `unknown` にして、理由を「Explorerでコード未公開のため権限関数を確認できない」みたいに返す（Unknownは失敗じゃない運用）([GitHub][1])

---

## ✅ Result の出し方（分かりやすい基準）

※ここは「スコア化」じゃなく、**状態分類（ok/warn/high/unknown）**です。([GitHub][1])

* **ok**：owner痕跡が見当たらない、または権限変更を示す要素が取れない（かつ根拠を説明できる）
* **warn**：owner痕跡があり、ルール変更系のシグナルがいくつか見える（“後から変えられる可能性”）
* **high**：owner痕跡＋“制限/締め上げ/選別”に直結しやすい強いシグナルが見える（例：blacklist系など）
* **unknown**：必要データが取れない（未verified等）→「取れない理由」をEvidenceに書く([GitHub][1])



### Task 07 でできるようになること（完了後・ざっくり）

* `/api/inspect` に **Check②（Owner Privileges / オーナー権限）** が追加され、**unknown以外（ok/warn/high）** が返るケースが出てくる
* **「なぜそう言えるか」** を `why` と `evidence` で説明できる（断定なし）
* 次の Task 08（Check③）以降を **同じ型で積み増し**できる

---

## ✅ タスク文ここから

```md
# Task 07 — Check ②: Owner Privileges (Phase 1 / Stage 4)

## PR title rule (MUST)
Set the PR title to:
- **Task 07: Check 02 (owner privileges)**

## What is Check ②?
**Owner Privileges（オーナー権限）**
- 目的：開発者（owner）が後から重要ルールを変更できる設計かどうか、という「リスクになりやすいシグナル」を検出する。
- 注意：これは断定ではない。可能性/シグナルとして説明する。

## Source of truth (MUST FOLLOW)
- Specs: `docs/specs/**`（spec-phase1-ja.md の「② Owner Privileges」定義を厳密に採用）
- Ops rules: `AGENTS.md`, `codex/**`
- Common rules: `codex/tasks/task-00-rules.md`

## Allowed changes
- May add/update: `workers/**`
- Must NOT edit: `docs/specs/**`

## Hard constraints (MUST)
- No new endpoints
- No schema changes（レスポンスのトップレベルキー追加禁止）
- No scoring/ranking/points
- No verdict words（scam/fraud/safe 等）& 投資助言禁止
- Cache HIT は即return（上流呼び出し・解析をしない）

---

## Implementation requirements

### 1) Identify the exact check object from specs
Implement Check②を **仕様書どおりの id/label/説明文** で `checks[]` に入れる。
- id / label / short / detail / howToVerify（仕様にあるなら）を一致させる
- 仕様にない文言を勝手に作らない（必要なら最小限の補助だけ）

### 2) Use only currently available data (Phase 1)
使ってよい情報：
- Task 05 で取得できる Explorer データ（ETH/BSC）
- Explorer から取れる “ソース/ABI/関数名/文字列” 等の範囲（存在する場合のみ）

禁止：
- HTMLスクレイピング
- 新しい外部API追加
- 新しいインフラ（DB/KV/R2等）

### 3) Detection approach (best-effort, explainable)
仕様に沿って「owner権限のシグナル」を拾う。実装は軽く：

- ソース/ABI が取得できる場合：
  - owner痕跡（例：`owner`, `onlyOwner`, `transferOwnership`, `renounceOwnership` など）の存在を確認
  - ルール変更系の“ヒント”関数名/文字列（例：`setFee/setTax/setMaxTx/setMaxWallet/blacklist/whitelist` 等）を **pattern scan** で拾う
  - 見つけたものは `evidence` に「見つかった語/関数名」として列挙（断定しない）

- 取得できない場合（未verified / APIキーなし / rate limit 等）：
  - 結果は `unknown`
  - `why` に「なぜ確認できないか」を明記
  - `evidence` にも `code: missing_api_key` 等の説明を残す（スキーマの許す範囲で）

### 4) Result classification (must follow spec wording)
Check②の `result` は仕様書のルールに従って：
- `ok | warn | high | unknown` のいずれか

実装上の最低要件（※最終判断は specs に完全準拠）：
- `unknown`：必要データが取れない
- `warn/high`：owner痕跡があり、変更系シグナルが見つかった（強さは仕様の定義に合わせる）
- `ok`：仕様が ok を許す条件を満たす場合のみ（無理にokにしない）

### 5) Evidence / how to verify
- `result != unknown` のとき `evidence` は最低1件入れる
  - 例：Explorer URL、検出した語/関数名、取得元（explorer）など
- `howToVerify` が仕様にあるなら必ず埋める
  - 無い場合は `why` の末尾に「確認方法（中立）」を短く追記

### 6) Preserve caching behavior
- Cache HIT：即 return（このチェック計算も含め “キャッシュ済み結果” を返す）
- Cache MISS：現行のパイプラインで上流取得→本チェック評価→レスポンス→キャッシュ保存（Task 04方針維持）

---

## Acceptance checklist
- [ ] Check②が specs の順番/名称/id で実装されている（勝手に変えてない）
- [ ] データが取れるとき `ok/warn/high` が返るケースがある
- [ ] 取れないとき `unknown` + 理由（why）が返る
- [ ] `result != unknown` のとき evidence が最低1件ある
- [ ] スキーマ変更なし／新規エンドポイントなし
- [ ] 禁止ワード/助言/スコア化なし
- [ ] Cache HIT の挙動が崩れていない
- [ ] `docs/specs/**` を編集していない
```

## ✅ タスク文ここまで

https://github.com/badjoke-lab/token-scam-inspector/pull/8

https://e71ccad5.token-scam-inspector.pages.dev/


---


### Check③は何だ／何を測る項目だ

**③ Mint Capability（追加発行の可否）**

* **測ること**：トークン供給を **後から増やせる（mintできる）設計か**
* **なぜ重要**：無制限mint等が可能だと、供給増で価値が崩れるリスク要因になりやすい（※断定はしない。シグナルとして扱う）



### Task 08 でできるようになること（完了後・ざっくり）

* `/api/inspect` に **Check③（Mint Capability）** が追加され、データが取れる場合は **ok/warn/high** が返る
* **mint関連シグナル（mint関数や役割/権限痕跡）** を `evidence` に出せる
* 取れない場合も **unknown＋理由** で返せる（壊れない）

---

## ✅ タスク文ここから

```md
# Task 08 — Check ③: Mint Capability (Phase 1 / Stage 4)

## PR title rule (MUST)
Set the PR title to:
- **Task 08: Check 03 (mint capability)**

## What is Check ③?
**Mint Capability（追加発行の可否）**
- 目的：供給を後から増やせる設計かどうかの「リスクシグナル」を検出する（断定しない）。

## Source of truth (MUST FOLLOW)
- Specs: `docs/specs/**`（spec-phase1-ja.md の「③ Mint Capability」定義を厳密に採用）
- Ops rules: `AGENTS.md`, `codex/**`
- Common rules: `codex/tasks/task-00-rules.md`

## Allowed changes
- May add/update: `workers/**`
- Must NOT edit: `docs/specs/**`

## Hard constraints (MUST)
- No new endpoints
- No response schema changes（トップレベルキー追加禁止）
- No scoring/ranking/points
- No verdict words（scam/fraud/safe 等）& 投資助言禁止
- Cache HIT は即return（上流呼び出し・解析をしない）

---

## Implementation requirements

### 1) Implement Check③ exactly as specified
- `checks[]` に Check③を **仕様書の順序/名称/id/文言** で追加する
- short / why / evidence / howToVerify（仕様にある場合）を一致させる
- 仕様にない説明を勝手に増やさない（必要最小限の補助のみ）

### 2) Data sources (Phase 1)
使用してよい情報：
- Task 05 の Explorer データ（ETH/BSC）
- 取得できる場合のみ：Verified source / ABI / 関数名 / コード文字列

禁止：
- HTMLスクレイピング
- 新しい外部API追加
- 新しいインフラ（DB/KV/R2等）

### 3) Detection (best-effort, explainable)
ソース/ABI が取れる場合：
- mintシグナルを **軽い pattern scan** で拾う（重い解析禁止）
  - 例：`mint`, `_mint`, `mintTo`, `mint(address`, `increaseSupply`
  - 役割/権限系：`MINTER_ROLE`, `onlyMinter`, `setMinter`, `addMinter`
- 見つけた語や関数名は `evidence` に「検出されたシグナル」として列挙（断定しない）

取れない場合（未verified / APIキーなし / rate limit 等）：
- `result: unknown`
- `why` に「なぜ確認できないか」を明記
- `evidence` にも “source_unavailable / missing_api_key / upstream_error”等の理由を残す（スキーマの許す範囲で）

### 4) Result classification (follow specs)
`result` は仕様書の基準に従って `ok | warn | high | unknown` を返す。
実装上の最低要件（※最終判断は specs に完全準拠）：
- `unknown`：必要データが取れない
- `warn/high`：mintシグナルが確認できる（強さは specs の定義に従う）
- `ok`：仕様が ok を許す条件を満たす場合のみ（無理にokにしない）

### 5) Evidence / how to verify
- `result != unknown` のとき `evidence` を最低1件入れる
  - 例：Explorer URL、検出語（mint / MINTER_ROLE 等）、取得元（explorer）
- `howToVerify` が仕様にあるなら必ず埋める
  - 無い場合は `why` 末尾に中立な確認手順を短く追記

### 6) Preserve caching behavior
- Cache HIT：即 return（キャッシュ済み結果を返す）
- Cache MISS：上流取得→本チェック評価→レスポンス→キャッシュ保存（Task 04方針維持）

## Acceptance checklist
- [ ] Check③（Mint Capability）が specs の順番/名称/id で実装されている
- [ ] データが取れるとき `ok/warn/high` が返るケースがある
- [ ] 取れないとき `unknown` + 理由（why）が返る
- [ ] `result != unknown` のとき evidence が最低1件ある
- [ ] スキーマ変更なし／新規エンドポイントなし
- [ ] 禁止ワード/助言/スコア化なし
- [ ] Cache HIT の挙動が崩れていない
- [ ] `docs/specs/**` を編集していない
```

## ✅ タスク文ここまで

https://github.com/badjoke-lab/token-scam-inspector/pull/9

https://9e939632.token-scam-inspector.pages.dev/



---


### Check④は何だ／何を測る項目だ

**④ Liquidity Lock Status（流動性ロック状況）**

* **測ること**：流動性（LP）が **ロック／焼却されていて抜けない状態か**、それとも **抜ける可能性があるか**
* **なぜ重要**：流動性が抜かれると、売却が困難になりやすい（※断定ではなくリスクシグナル）

※仕様書にもある通り、Phase 1 は無料枠・外部取得制限があるので、**「確認できる/できない」を正直に返す（unknown + 理由）**を許容するチェックです。


### Task 09 でできるようになること（完了後・ざっくり）

* `/api/inspect` に **Check④（Liquidity Lock Status）** が追加される
* Phase 1で確認不能な場合でも **unknown＋理由** を返して“壊れない”
* UI側は「流動性ロックも確認対象に入っている」ことが **説明つきで表示可能**になる

---

## ✅ タスク文ここから

```md
# Task 09 — Check ④: Liquidity Lock Status (Phase 1 / Stage 4)

## PR title rule (MUST)
Set the PR title to:
- **Task 09: Check 04 (liquidity lock)**

## What is Check ④?
**Liquidity Lock Status（流動性ロック状況）**
- 目的：LPがロック/焼却されていて抜けにくいか、抜ける可能性があるか、というリスクシグナルを説明する。
- 注意：断定しない。Phase 1 では取得制限により unknown が多くてよい（理由を必ず返す）。

## Source of truth (MUST FOLLOW)
- Specs: `docs/specs/**`（spec-phase1-ja.md の「④ Liquidity Lock Status」定義を厳密に採用）
- Ops rules: `AGENTS.md`, `codex/**`
- Common rules: `codex/tasks/task-00-rules.md`

## Allowed changes
- May add/update: `workers/**`
- Must NOT edit: `docs/specs/**`

## Hard constraints (MUST)
- No new endpoints
- No response schema changes（トップレベルキー追加禁止）
- No scoring/ranking/points
- No verdict words（scam/fraud/safe 等）& 投資助言禁止
- Cache HIT は即return（上流呼び出し・解析をしない）

---

## Implementation requirements

### 1) Implement Check④ exactly as specified
- `checks[]` に Check④を **仕様書の順序/名称/id/文言** で追加する
- Short / Why / Evidence / How to verify を仕様書に合わせて埋める（フィールド名は既存スキーマに合わせる）

### 2) Phase 1 limitation must be explicit (spec-aligned)
Phase 1（無料枠）ではLPロックを確実に検証するデータが取れないケースが多い。
その場合は:
- `result: "unknown"`
- `detail/why` に「Phase 1の制限でLPロック確認ができない」理由を明記
- `evidence` にも「LPロック確認不可（Phase 1制限）」等を1件入れる（スキーマの許す範囲で）

※このチェックは「unknownでも価値がある（確認すべき点を案内できる）」ことが前提。

### 3) Best-effort (optional) — only if already available without new infra
- 既に Task 05 で取れている情報だけで「確実に言える」ことがあるなら evidence に追加してよい
- ただし以下は禁止：
  - 新しい外部API追加
  - HTMLスクレイピング
  - DB/KV/R2追加

### 4) How to verify (beginner-friendly)
`howToVerify` を必ず入れる（仕様書の趣旨に沿って中立に）：
例（中立）：
- “Check the LP token holder on the DEX pair and see if it is locked/burned.”
- “Look for a reputable locker (Team Finance / Unicrypt etc.) and verify the lock transaction.”
- “If liquidity is burned, verify LP tokens are sent to a dead address.”

※投資助言ではなく「確認手順」として書く。

### 5) Preserve caching behavior
- Cache HIT：即 return（キャッシュ済み結果を返す）
- Cache MISS：現行パイプラインでこのチェックを組み立てて返し、キャッシュ保存（Task 04方針維持）

## Acceptance checklist
- [ ] Check④（Liquidity Lock Status）が specs の順番/名称/id で実装されている
- [ ] 取得不能時に `unknown` + 理由（detail/why）が返る
- [ ] `evidence` が最低1件ある（unknownでも「確認不可理由」を入れる）
- [ ] `howToVerify` が初心者向けに中立で書かれている
- [ ] スキーマ変更なし／新規エンドポイントなし
- [ ] 禁止ワード/助言/スコア化なし
- [ ] Cache HIT の挙動が崩れていない
- [ ] `docs/specs/**` を編集していない
```

## ✅ タスク文ここまで

https://github.com/badjoke-lab/token-scam-inspector/pull/10

https://a7ac567c.token-scam-inspector.pages.dev/



---


### Check⑤は何だ／何を測る項目だ

**⑤ Holder Concentration（保有集中）**

* **測ること**：上位少数のウォレットがトークンを握りすぎていないか（Top1 / Top5 / Top10 の保有割合）
* **なぜ重要**：少数が大量に持っていると、一気に売られて価格が崩れるリスク要因になりやすい（※断定ではなく“リスクシグナル”）




### Task 10 でできるようになること（完了後・ざっくり）

* `/api/inspect` に **Check⑤（Holder Concentration）** が追加される
* 取れる場合は **Top 1/5/10 holders %** を `evidence` に入れて **ok/warn/high** を返せる
* 取れない場合も **unknown＋理由** を返して壊れない（Phase 1 方針どおり）

---

## ✅ タスク文ここから

```md
# Task 10 — Check ⑤: Holder Concentration (Phase 1 / Stage 4)

## PR title rule (MUST)
Set the PR title to:
- **Task 10: Check 05 (holder concentration)**

## What is Check ⑤?
**Holder Concentration（保有集中）**
- 目的：上位少数アドレスが供給の大部分を握っていないか（Top 1/5/10 holders %）というリスクシグナルを説明する。
- 注意：断定しない。取得できなければ unknown + 理由で返す。

## Source of truth (MUST FOLLOW)
- Specs: `docs/specs/**`（spec-phase1-ja.md の「⑤ Holder Concentration」定義を厳密に採用）
- Ops rules: `AGENTS.md`, `codex/**`
- Common rules: `codex/tasks/task-00-rules.md`

## Allowed changes
- May add/update: `workers/**`
- Must NOT edit: `docs/specs/**`

## Hard constraints (MUST)
- No new endpoints
- No response schema changes（トップレベルキー追加禁止）
- No scoring/ranking/points
- No verdict words（scam/fraud/safe 等）& 投資助言禁止
- Cache HIT は即return（上流呼び出し・解析をしない）
- HTMLスクレイピング禁止（Explorerページ解析はしない）

---

## Implementation requirements

### 1) Implement Check⑤ exactly as specified
- `checks[]` に Check⑤を **仕様書の順序/名称/id/文言** で追加する
- Short / detail / evidence / howToVerify を仕様書に合わせて埋める（フィールド名は既存スキーマに合わせる）

### 2) Data sources (Phase 1)
使用してよい情報：
- Task 05 で整備済みの Explorer API 呼び出し基盤（ETH/BSC）
- APIキーは env（既存方針に従う）

禁止：
- 新規外部APIの追加（別サービス導入）
- HTMLスクレイピング
- 新インフラ（DB/KV/R2等）

### 3) Holder data retrieval (best-effort)
- Explorer APIで「上位保有者一覧」または同等情報が取れる場合のみ利用する。
- 取得できたら：
  - Top1 / Top5 / Top10 の合計割合（%）を計算し、`evidence` に入れる
  - 例（evidence）:
    - "Top 1 holders: 18.2%"
    - "Top 5 holders: 41.0%"
    - "Top 10 holders: 55.6%"
    - "Source: explorer API"
- 取得できない/未対応/失敗したら：
  - `result: "unknown"`
  - `detail/why` に「Phase 1ではホルダー分布を取得できない理由（API非対応/権限/制限/レート等）」を明記
  - `evidence` にも1件入れる（例："Holder list not available via free explorer API in Phase 1"）

### 4) Result classification (follow specs)
`result` は仕様書の基準に従って `ok | warn | high | unknown` を返す。
- ok/warn/high の閾値・考え方は specs に完全準拠（勝手に新しい基準を追加しない）
- 取得できない場合は必ず unknown

### 5) How to verify (beginner-friendly, neutral)
- `howToVerify` を必ず入れる（仕様趣旨に沿って中立に）
例（中立）：
- "Open the token holders page on the explorer and check Top holders distribution."
- "Compare Top 1/5/10 share and watch for unusually high concentration."
※投資助言ではなく「確認手順」。

### 6) Preserve caching behavior
- Cache HIT：即 return（キャッシュ済み結果を返す）
- Cache MISS：上流取得→本チェック評価→レスポンス→キャッシュ保存（Task 04方針維持）

## Acceptance checklist
- [ ] Check⑤（Holder Concentration）が specs の順番/名称/id で実装されている
- [ ] 取得できる場合 Top1/5/10 % が evidence に入る
- [ ] 取得できない場合 unknown + 理由（detail/why）が返る
- [ ] unknownでも evidence が最低1件ある（「取れない理由」）
- [ ] スキーマ変更なし／新規エンドポイントなし
- [ ] 禁止ワード/助言/スコア化なし
- [ ] Cache HIT の挙動が崩れていない
- [ ] `docs/specs/**` を編集していない
```

## ✅ タスク文ここまで

https://github.com/badjoke-lab/token-scam-inspector/pull/11

https://64db49e7.token-scam-inspector.pages.dev/



---

### Check⑥は何だ／何を測る項目だ

**⑥ Contract Verification（ソース公開・検証済みか）**

* **測ること**：Explorer上で **コントラクトが Verified（ソース公開）** かどうか
* **なぜ重要**：ソースが見えないと、上のチェック（owner権限・mint等）も **検証不能＝unknownが増える**。
  ＝「透明性が低い」というシグナルになる（※断定ではなく“確認可能性”の話）

---

### Task 11 でできるようになること（完了後・ざっくり）

* `/api/inspect` に **Check⑥（Contract Verification）** が追加される
* Verified/Unverified を **ok/warn/high/unknown** で返せる（仕様の定義に従う）
* `evidence` に **Verified状態とExplorer URL** を入れられる

---

## ✅ タスク文ここから

```md
# Task 11 — Check ⑥: Contract Verification (Phase 1 / Stage 4)

## PR title rule (MUST)
Set the PR title to:
- **Task 11: Check 06 (contract verification)**

## What is Check ⑥?
**Contract Verification（ソース公開・検証済みか）**
- 目的：Explorer上でコントラクトが verified（ソース公開）かどうかを示す。
- 注意：断定ではなく「検証可能性/透明性」のシグナルとして説明する。

## Source of truth (MUST FOLLOW)
- Specs: `docs/specs/**`（spec-phase1-ja.md の「⑥ Contract Verification」定義を厳密に採用）
- Ops rules: `AGENTS.md`, `codex/**`
- Common rules: `codex/tasks/task-00-rules.md`

## Allowed changes
- May add/update: `workers/**`
- Must NOT edit: `docs/specs/**`

## Hard constraints (MUST)
- No new endpoints
- No response schema changes
- No scoring/ranking/points
- No verdict words（scam/fraud/safe 等）& 投資助言禁止
- Cache HIT は即return（上流呼び出し・解析をしない）
- HTMLスクレイピング禁止

---

## Implementation requirements

### 1) Implement Check⑥ exactly as specified
- `checks[]` に Check⑥を **仕様書の順序/名称/id/文言** で追加する
- short / detail / evidence / howToVerify を仕様に合わせる（既存スキーマ範囲内）

### 2) Use existing explorer foundation
- Task 05で作った explorer取得の結果から「verifiedかどうか」を判定する
  - 例：source code取得が成功している、または explorer API が verified flag を返す等
- チェーン（ETH/BSC）ごとの違いは、既存の正規化層があるならそこに寄せる（無ければ最小で追加）

### 3) Result classification (follow specs)
- `ok/warn/high/unknown` の判定基準は **spec-phase1-ja.md** に完全準拠
- 取得不能なら `unknown` + 理由

### 4) Evidence + how to verify
- `evidence` に最低1件入れる：
  - Verifiedなら：`"Verified source code: yes"` + explorer URL
  - Unverifiedなら：`"Verified source code: no"` + explorer URL
  - Unknownなら：取れない理由（missing_api_key/upstream_error等） + explorer URL（可能なら）
- `howToVerify` に中立な確認手順（仕様に沿う）：
  - "Open the explorer page and check whether the contract is verified."

### 5) Preserve caching behavior
- Cache HIT：即 return
- Cache MISS：現行のパイプラインでこのチェックを組み立てて返し、キャッシュ保存（Task 04維持）

## Acceptance checklist
- [ ] Check⑥（Contract Verification）が specs の順番/名称/id で実装されている
- [ ] Verified/Unverified/Unknown のいずれかを返せる
- [ ] evidence が最低1件あり、可能なら explorer URL を含む
- [ ] howToVerify が中立で初心者向け
- [ ] スキーマ変更なし／新規エンドポイントなし
- [ ] 禁止ワード/助言/スコア化なし
- [ ] Cache HIT の挙動が崩れていない
- [ ] `docs/specs/**` を編集していない
```

## ✅ タスク文ここまで

https://github.com/badjoke-lab/token-scam-inspector/pull/12

https://64db49e7.token-scam-inspector.pages.dev/




---

### Check⑦は何だ／何を測る項目だ

**⑦ Trading Enable Control（取引停止・制限の制御）**

* **測ること**：コントラクト側に **取引を止める／再開する** 仕組み（pause / tradingEnabled 等）があるか
* **狙い**：買った後に取引を止められる設計はリスクシグナルになり得る（※断定しない）

---

### Task 12 でできるようになること（完了後・ざっくり）

* `/api/inspect` に **Check⑦（Trading Enable Control）** が追加される
* ソース/ABI が取れるときは **pause / tradingEnabled 系シグナル**を `evidence` に出して **ok/warn/high** を返せる
* 取れないときも **unknown＋理由** で返して壊れない

---

## ✅ タスク文ここから

```md
# Task 12 — Check ⑦: Trading Enable Control (Phase 1 / Stage 4)

## PR title rule (MUST)
Set the PR title to:
- **Task 12: Check 07 (trading enable control)**

## What is Check ⑦?
**Trading Enable Control（取引停止・制限の制御）**
- 目的：取引を停止/制限できる設計（pause / tradingEnabled 等）の「リスクシグナル」を検出し、説明する（断定しない）。

## Source of truth (MUST FOLLOW)
- Specs: `docs/specs/**`（spec-phase1-ja.md の「⑦ Trading Enable Control」定義を厳密に採用）
- Ops rules: `AGENTS.md`, `codex/**`
- Common rules: `codex/tasks/task-00-rules.md`

## Allowed changes
- May add/update: `workers/**`
- Must NOT edit: `docs/specs/**`

## Hard constraints (MUST)
- No new endpoints
- No response schema changes（トップレベルキー追加禁止）
- No scoring/ranking/points
- No verdict words（scam/fraud/safe 等）& 投資助言禁止
- Cache HIT は即return（上流呼び出し・解析をしない）
- HTMLスクレイピング禁止
- 新しい外部API追加禁止（Task 05 の explorer基盤のみ）

---

## Implementation requirements

### 1) Implement Check⑦ exactly as specified
- `checks[]` に Check⑦を **仕様書の順序/名称/id/文言** で追加する
- Short / Why / Evidence / 短文要約 / howToVerify（仕様にあるなら）を仕様書どおりに（既存スキーマ範囲内）

### 2) Data sources (Phase 1)
使ってよい情報：
- Task 05 の Explorer データ（ETH/BSC）
- 取得できる場合のみ：Verified source / ABI / 関数名 / コード文字列

禁止：
- HTMLスクレイピング
- 新規外部サービス導入
- DB/KV/R2等の追加

### 3) Detection (best-effort, explainable)
ソース/ABI が取れる場合：
- “取引停止/再開/ON-OFF” 系の **pattern scan** を行い、見つけた語を `evidence` に列挙（断定しない）
  - 例（候補パターン）：
    - `pause`, `paused`, `unpause`
    - `tradingEnabled`, `enableTrading`, `disableTrading`
    - `setTrading`, `openTrading`, `tradingActive`
    - `stopTrading`, `resumeTrading`
- 見つけたものは evidence に「検出されたシグナル」として記録
  - 例：`"Detected signal: tradingEnabled"` / `"Detected signal: pause()"`

取れない場合（未verified / APIキーなし / upstream error / rate limit 等）：
- `result: "unknown"`
- `why/detail` に「なぜ確認できないか」を明記
- `evidence` にも「source_unavailable / missing_api_key / upstream_error」等を1件入れる（既存スキーマ範囲内）

### 4) Result classification (follow specs)
- `result` は specs に完全準拠して `ok | warn | high | unknown`
- 取れないなら必ず unknown
- ok を無理に付けない（仕様が ok を許す条件のみ）

### 5) How to verify (neutral, beginner-friendly)
- `howToVerify` を仕様趣旨に沿って中立に書く（投資助言禁止）
  - 例：Explorerで verified source を開いて “pause/tradingEnabled” の有無を確認する、等

### 6) Preserve caching behavior
- Cache HIT：即 return
- Cache MISS：上流取得→本チェック評価→レスポンス→キャッシュ保存（Task 04方針維持）

## Acceptance checklist
- [ ] Check⑦が specs の順番/名称/id で実装されている
- [ ] 取れるとき `ok/warn/high` が返るケースがある
- [ ] 取れないとき `unknown` + 理由（why/detail）が返る
- [ ] unknownでも evidence が最低1件ある（取れない理由）
- [ ] 禁止ワード/助言/スコア化なし
- [ ] Cache HIT の挙動が崩れていない
- [ ] `docs/specs/**` を編集していない
```

## ✅ タスク文ここまで

https://github.com/badjoke-lab/token-scam-inspector/pull/13

https://2f375e97.token-scam-inspector.pages.dev/



### Task 13 でできるようになること（完了後・ざっくり）

* `checks[]` の結果から **overallRisk（low/medium/high/unknown）** を **仕様書どおりのルール**で自動決定できる
* **summary（1行サマリー）** が毎回自動で埋まる（断定なし・中立表現）
* **topReasons（最大3件）** が **high/warn の原因チェック**から自動生成される（UIにそのまま出せる）

---

## ✅ タスク文ここから

```md
# Task 13 — Build overallRisk / summary / topReasons (Phase 1 / Stage 4)

## PR title rule (MUST)
Set the PR title to:
- **Task 13: Overall risk + top reasons**

## Goal
Implement the Phase 1 aggregation logic:
- Compute `overallRisk` from `checks[]` results (spec-aligned)
- Generate `summary` (one-line, neutral)
- Generate `topReasons` (max 3) from high/warn checks
No new checks. No schema changes.

## Source of truth (MUST FOLLOW)
- Specs: `docs/specs/**`  
  - Specifically: `spec-phase1-ja.md` section **"8. Overall Risk 表示ルール（改訂）"**
- Ops rules: `AGENTS.md`, `codex/**`
- Common rules: `codex/tasks/task-00-rules.md`

## Allowed changes
- May add/update: `workers/**`
- Must NOT edit: `docs/specs/**`

## Hard constraints (MUST)
- No new endpoints
- No response schema changes（トップレベルキー追加禁止）
- No scoring/ranking/points
- No verdict words（scam/fraud/safe 等）& 投資助言禁止
- Cache HIT は即return（上流呼び出し・解析をしない）

---

## Implementation requirements

### 1) Implement overallRisk decision rules (spec exact)
Follow the table in specs ("8. Overall Risk 表示ルール"):

- If any check has `result: "high"` -> `overallRisk = "high"`
- Else if `warn` count >= 1 -> `overallRisk = "medium"`
- Else if all checks are `ok` -> `overallRisk = "low"`
- Else if unknown is dominant -> `overallRisk = "unknown"`

**Define "unknown dominant" (deterministic, minimal)**
To avoid ambiguity while staying conservative:
- If `high==0` and `warn==0` and `unknown>=1` -> `overallRisk = "unknown"`
(Keep it simple; do not invent complex thresholds.)

### 2) Generate `topReasons` (max 3)
- Pick checks with `result` in: `high`, `warn`
- Order:
  1) all `high` first (in the same order as `checks[]`)
  2) then `warn` (in the same order)
- `topReasons` strings should be human-readable and neutral.
  - Use the check’s `short` text (already spec-aligned) as the reason text.
- Max 3 items.
- If none (all ok/unknown): `topReasons` should be empty array `[]` (do not invent reasons).

### 3) Generate `summary` (one-line, neutral)
Produce a single short line that:
- Mentions the `overallRisk` level (Low/Medium/High/Unknown wording is OK)
- Adds a neutral clause:
  - If high/medium: “Some risk indicators were detected.”
  - If unknown: “Insufficient data to confirm key signals.”
  - If low: “No strong risk indicators were detected in these checks.”
- Must NOT use banned verdict words or investment advice.

Examples (conceptual; keep short):
- high: "High: Multiple strong risk indicators were detected."
- medium: "Medium: Some risk indicators were detected."
- low: "Low: No strong risk indicators were detected in these checks."
- unknown: "Unknown: Insufficient data to confirm key signals."

### 4) No schema changes
- Only populate existing fields:
  - `overallRisk`
  - `summary`
  - `topReasons`
- Do not add new top-level keys.
- Do not rename keys.

### 5) Preserve caching behavior
- Cache HIT: return cached response as-is
- Cache MISS: compute response, then set overall/summary/topReasons, then cache

## Acceptance checklist
- [ ] overallRisk follows spec rule table (deterministic)
- [ ] summary is 1 line, neutral, no banned words
- [ ] topReasons derived only from high/warn checks, max 3, stable order
- [ ] No schema changes / no new endpoints
- [ ] Cache HIT path unchanged
- [ ] `docs/specs/**` not edited
```

## ✅ タスク文ここまで

https://github.com/badjoke-lab/token-scam-inspector/pull/14

https://c8ba1e22.token-scam-inspector.pages.dev/



